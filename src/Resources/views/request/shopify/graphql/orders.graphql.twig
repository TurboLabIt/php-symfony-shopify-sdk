{# https://shopify.dev/api/admin/graphql/reference/orders/order #}
{
  orders(first: {{ shopify_config.results_per_page }}, reverse:true,
        query:"{% if selectOrderAfterDate is defined %}updated_at:>{{ selectOrderAfterDate }}{% endif %}") {
    edges {
      node {
        id
        email
        note
        phone
        name
        fulfillmentOrders(first:4) {
          edges{
            node {
              id
              status
              assignedLocation {
                name
              }
            }
          }
        }
        originalTotalPriceSet {
          shopMoney {
            amount
            currencyCode
          }
        }
        createdAt
        updatedAt
        closedAt
        cancelledAt
        cancelReason
        unpaid
        billingAddress {
          firstName
          lastName
          company
          address1
          address2
          city
          zip
          province
          provinceCode
          country
          countryCodeV2
          phone
        }
        shippingAddress {
          firstName
          lastName
          company
          address1
          address2
          city
          zip
          province
          provinceCode
          country
          countryCodeV2
          phone
        }
        customerAcceptsMarketing
        lineItems(first:10) {
          edges {
            node {
              name
              customAttributes {
                value
              }
              variant {
                barcode
              }
              discountedUnitPriceSet {
                shopMoney {
                  amount
                  currencyCode
                }
              }
              discountedTotalSet {
                shopMoney {
                  amount
                  currencyCode
                }
              }
              customAttributes {
                key
                value
              }
              id
              sku
              quantity
              variant {
                id
                displayName
                inventoryQuantity
                barcode
                price
              }
              product {
                id
                productType
                productCategory{
                  productTaxonomyNode {
                    id
                    fullName
                    name
                  }
                }
                status
                totalInventory
                tags
                vendor
              }
              quantity
              taxLines {
                rate
                ratePercentage
                title
              }
            }
          }
        }
        localizationExtensions(first:50, countryCodes:[IT]) {
          edges {
            node {
              key
              purpose
              title
              value
            }
          }
        }
      }
    }
  }
}
